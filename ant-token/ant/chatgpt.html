<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UI Color System Generator (Ant Design Style)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .color-block { transition: transform 0.2s; }
        .color-block:hover { transform: scale(1.05); z-index: 10; }
        /* Custom scrollbar for table */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen p-6 md:p-12">

    <div class="max-w-5xl mx-auto">
        <!-- Header -->
        <div class="mb-10 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-3">UI Color System Generator</h1>
            <p class="text-gray-500">基于 Ant Design 算法生成色阶，并分析 S/B 增减量</p>
        </div>

        <!-- Input Section -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8 flex flex-col md:flex-row items-center justify-center gap-6">
            <div class="flex items-center gap-4">
                <div class="relative w-16 h-16 rounded-full overflow-hidden shadow-inner border-2 border-gray-100 group">
                    <input type="color" id="colorPicker" value="#1890ff" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[150%] h-[150%] p-0 border-0 cursor-pointer">
                </div>
                <div>
                    <label class="block text-xs font-semibold text-gray-400 uppercase tracking-wider mb-1">主色 (Primary)</label>
                    <div class="relative">
                        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">#</span>
                        <input type="text" id="hexInput" value="1890ff" class="pl-7 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono uppercase w-32 transition-all">
                    </div>
                </div>
            </div>
            <button id="generateBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg shadow-md transition-colors flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v3.25a1 1 0 11-2 0V15.4a7.002 7.002 0 01-11.55-2.228 1 1 0 01.557-1.116z" clip-rule="evenodd" />
                </svg>
                生成色阶
            </button>
        </div>

        <!-- Palette Display -->
        <div id="paletteContainer" class="grid grid-cols-5 md:grid-cols-10 gap-0 rounded-xl overflow-hidden shadow-lg mb-8 h-32 md:h-40">
            <!-- Colors will be injected here -->
        </div>

        <!-- Data Table -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div class="p-5 border-b border-gray-100 bg-gray-50 flex justify-between items-center">
                <h3 class="font-bold text-gray-700">数据分析 (S/B 增减量)</h3>
                <span class="text-xs text-gray-500 bg-gray-200 px-2 py-1 rounded">主色索引: 6</span>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left">
                    <thead class="bg-gray-50 text-gray-500 font-medium border-b border-gray-200">
                        <tr>
                            <th class="py-3 px-4">Step</th>
                            <th class="py-3 px-4">预览</th>
                            <th class="py-3 px-4">Hex</th>
                            <th class="py-3 px-4">Hue (色相)</th>
                            <th class="py-3 px-4">Sat (饱和度)</th>
                            <th class="py-3 px-4 text-blue-600 bg-blue-50">Δ Saturation</th>
                            <th class="py-3 px-4">Bri (亮度)</th>
                            <th class="py-3 px-4 text-orange-600 bg-orange-50">Δ Brightness</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody" class="divide-y divide-gray-100">
                        <!-- Rows will be injected here -->
                    </tbody>
                </table>
            </div>
            <div class="p-4 bg-gray-50 text-xs text-gray-500 border-t border-gray-200">
                <p><strong>说明：</strong> Δ (Delta) 表示当前步骤相对于上一步骤（Step N - Step N-1）的数值变化。</p>
            </div>
        </div>
    </div>

    <script>
        // --- Logic & Algorithms ---

        // Utility: Convert Hex to HSV (Hue, Saturation, Value/Brightness)
        function hexToHsv(hex) {
            hex = hex.replace(/^#/, '');
            if (hex.length === 3) hex = hex.split('').map(c => c + c).join('');
            
            let r = parseInt(hex.substring(0, 2), 16) / 255;
            let g = parseInt(hex.substring(2, 4), 16) / 255;
            let b = parseInt(hex.substring(4, 6), 16) / 255;

            let max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, v = max;
            let d = max - min;
            s = max === 0 ? 0 : d / max;

            if (max === min) {
                h = 0; // achromatic
            } else {
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }

            return {
                h: Math.round(h * 360),
                s: Math.round(s * 100),
                b: Math.round(v * 100) // HSV Value is Brightness
            };
        }

        // Utility: Convert HSV to Hex
        function hsvToHex(h, s, b) {
            s /= 100;
            b /= 100;
            
            let c = b * s;
            let x = c * (1 - Math.abs(((h / 60) % 2) - 1));
            let m = b - c;
            let r = 0, g = 0, bl = 0;

            if (0 <= h && h < 60) { r = c; g = x; bl = 0; }
            else if (60 <= h && h < 120) { r = x; g = c; bl = 0; }
            else if (120 <= h && h < 180) { r = 0; g = c; bl = x; }
            else if (180 <= h && h < 240) { r = 0; g = x; bl = c; }
            else if (240 <= h && h < 300) { r = x; g = 0; bl = c; }
            else if (300 <= h && h < 360) { r = c; g = 0; bl = x; }

            r = Math.round((r + m) * 255).toString(16).padStart(2, '0');
            g = Math.round((g + m) * 255).toString(16).padStart(2, '0');
            bl = Math.round((bl + m) * 255).toString(16).padStart(2, '0');

            return `#${r}${g}${bl}`.toUpperCase();
        }

        // --- Core Algorithm (Ant Design Style Logic) ---
        // Based on the classic Ant Design algorithm principles often cited in UISDC articles.
        function generatePalette(baseHex) {
            const baseHsv = hexToHsv(baseHex);
            const palette = [];
            
            // Standard Ant Design Steps
            // Light Steps (1-5): S decreases, B increases
            // Dark Steps (7-10): S increases, B decreases
            
            // Determine if color is Warm or Cool for Hue rotation
            // Cool: 60 <= H <= 240 (Green, Cyan, Blue)
            // Warm: 0-60, 240-360 (Red, Yellow, Magenta)
            const isCool = baseHsv.h >= 60 && baseHsv.h <= 240;
            
            // Step Increments (Classic approximation)
            // Light: Hue rotate, Sat -16, Bri +5
            // Dark: Hue rotate, Sat +5, Bri -15
            const lightSatStep = 16;
            const lightBriStep = 5;
            const darkSatStep = 5;
            const darkBriStep = 15;
            const hueStep = 2;

            for (let i = 1; i <= 10; i++) {
                let h = baseHsv.h;
                let s = baseHsv.s;
                let b = baseHsv.b;
                let hex = '';

                if (i === 6) {
                    // Base Color
                    hex = baseHex;
                } else if (i < 6) {
                    // Light Colors (1-5)
                    const stepsDown = 6 - i;
                    
                    // Hue Rotation
                    if (isCool) {
                        h = (h - (hueStep * stepsDown)) % 360; 
                    } else {
                        h = (h + (hueStep * stepsDown)) % 360;
                    }
                    if (h < 0) h += 360;

                    // Saturation (Decreases)
                    s = Math.max(2, s - (lightSatStep * stepsDown)); // Clamp to min 2%

                    // Brightness (Increases)
                    b = Math.min(100, b + (lightBriStep * stepsDown));
                    
                } else {
                    // Dark Colors (7-10)
                    const stepsUp = i - 6;

                    // Hue Rotation (Opposite direction)
                    if (isCool) {
                        h = (h + (hueStep * stepsUp)) % 360;
                    } else {
                        h = (h - (hueStep * stepsUp)) % 360;
                    }
                    if (h < 0) h += 360;

                    // Saturation (Increases)
                    s = Math.min(100, s + (darkSatStep * stepsUp));

                    // Brightness (Decreases)
                    b = Math.max(20, b - (darkBriStep * stepsUp)); // Clamp min 20%
                }

                hex = hsvToHex(h, s, b);
                palette.push({ step: i, hex: hex, h: Math.round(h), s: Math.round(s), b: Math.round(b) });
            }
            return palette;
        }

        // --- UI Rendering ---

        function render(baseColor) {
            // Ensure hex format
            if (!baseColor.startsWith('#')) baseColor = '#' + baseColor;
            
            const palette = generatePalette(baseColor);
            const paletteContainer = document.getElementById('paletteContainer');
            const dataTableBody = document.getElementById('dataTableBody');

            // Clear previous
            paletteContainer.innerHTML = '';
            dataTableBody.innerHTML = '';

            palette.forEach((item, index) => {
                // 1. Render Visual Block
                const block = document.createElement('div');
                block.className = 'color-block h-full flex flex-col justify-end p-2 cursor-pointer';
                block.style.backgroundColor = item.hex;
                
                // Text color calculation for contrast
                const textColor = item.b > 60 ? 'text-gray-800' : 'text-white';
                
                block.innerHTML = `
                    <span class="text-xs font-mono opacity-50 ${textColor}">${item.step}</span>
                    <span class="text-xs font-bold font-mono ${textColor}">${item.hex}</span>
                `;
                block.onclick = () => {
                    navigator.clipboard.writeText(item.hex);
                    // Simple feedback could be added here
                };
                paletteContainer.appendChild(block);

                // 2. Render Table Row with Deltas
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 transition-colors group';
                if (item.step === 6) row.classList.add('bg-blue-50/50'); // Highlight base

                // Calculate Deltas (Current - Previous)
                let deltaS = '-';
                let deltaB = '-';
                let deltaSClass = 'text-gray-400';
                let deltaBClass = 'text-gray-400';

                if (index > 0) {
                    const prev = palette[index - 1];
                    const diffS = item.s - prev.s;
                    const diffB = item.b - prev.b;

                    deltaS = diffS > 0 ? `+${diffS}%` : `${diffS}%`;
                    deltaB = diffB > 0 ? `+${diffB}%` : `${diffB}%`;

                    // Styling for deltas
                    if(diffS !== 0) deltaSClass = diffS > 0 ? 'text-green-600 font-semibold' : 'text-red-500 font-semibold';
                    if(diffB !== 0) deltaBClass = diffB > 0 ? 'text-green-600 font-semibold' : 'text-red-500 font-semibold';
                }

                row.innerHTML = `
                    <td class="py-3 px-4 font-medium text-gray-900">${item.step} ${item.step === 6 ? '(主色)' : ''}</td>
                    <td class="py-3 px-4">
                        <div class="w-8 h-8 rounded shadow-sm border border-gray-200" style="background-color: ${item.hex}"></div>
                    </td>
                    <td class="py-3 px-4 font-mono text-gray-600 select-all">${item.hex}</td>
                    <td class="py-3 px-4 text-gray-600">${item.h}°</td>
                    <td class="py-3 px-4 font-mono text-gray-700">${item.s}%</td>
                    <td class="py-3 px-4 font-mono bg-blue-50/30 ${deltaSClass}">${deltaS}</td>
                    <td class="py-3 px-4 font-mono text-gray-700">${item.b}%</td>
                    <td class="py-3 px-4 font-mono bg-orange-50/30 ${deltaBClass}">${deltaB}</td>
                `;
                dataTableBody.appendChild(row);
            });
        }

        // --- Event Listeners ---

        const colorPicker = document.getElementById('colorPicker');
        const hexInput = document.getElementById('hexInput');
        const generateBtn = document.getElementById('generateBtn');

        // Sync Hex Input -> Picker
        hexInput.addEventListener('input', (e) => {
            let val = e.target.value.replace(/[^0-9a-fA-F]/g, '');
            if (val.length > 6) val = val.substring(0, 6);
            e.target.value = val;
            
            if (val.length === 6) {
                colorPicker.value = '#' + val;
            }
        });

        // Sync Picker -> Hex Input
        colorPicker.addEventListener('input', (e) => {
            hexInput.value = e.target.value.substring(1).toUpperCase();
        });

        // Generate on Click
        generateBtn.addEventListener('click', () => {
            const hex = hexInput.value;
            if (hex.length < 3) {
                alert('请输入有效的 Hex 颜色代码');
                return;
            }
            render(hex);
        });

        // Press Enter to generate
        hexInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') generateBtn.click();
        });

        // Initialize
        render('1890ff');

    </script>
</body>
</html>